<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="shortcut icon"
      href="https://img.icons8.com/office/16/000000/sunset--v2.png"
      type="image/x-icon"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="index.css" type="text/css" />
    <title>Weather App</title>
  </head>

  <body>
    <form action="/" method="post">
      <label for="city">City Name: </label>
      <input type="text" name="cityname" id="cityname" />
      <button type="submit">Go</button>
    </form>

    <%if( weather !== null){ %>
    <div class="box">
      <div class="wave one"></div>
      <div class="wave two"></div>
      <div class="wave three"></div>

      <div id="weathercon">
        <img src="<%= icon %>" alt="Weather-Icon">
      </div>

      <div class="info">
        <h2 class="location">
          <i class="fa-solid fa-street-view"></i> <%=location%>,<%=country%>
        </h2>
        <p id="date">WED | OCT 23 | 10:49AM</p>
        <h1 class="temp"><%=tempVal%> ℃</h1>
        <h3 class="temp_min_max">Min <%=tempmin%> ℃ | Max <%=tempmax%> ℃</h3>
      </div>
    </div>
    <% } %> 
    <% if(error !== null){ %>
    <p><%= error %></p>
    <% } %>

    <script >
      const currDate = document.getElementById("date");
  
        function getCurrentDay() {
          let weekDay = new Array(7);
          weekDay[0] = "Sun";
          weekDay[1] = "Mon";
          weekDay[2] = "Tue";
          weekDay[3] = "Wed";
          weekDay[4] = "Thu";
          weekDay[5] = "Fri";
          weekDay[6] = "Sat";
          let currentTime = new Date();
          return weekDay[currentTime.getDay()];
        }
  
        function getCurrentTime() {
          var months = [
            "Jan",
            "Feb",
            "Mar",
            "Apr",
            "May",
            "Jun",
            "Jul",
            "Aug",
            "Sep",
            "Oct",
            "Nov",
            "Dec",
          ];
          let now = new Date();
          let month = months[now.getMonth()];
          let date = now.getDate();
  
          let time = now.getHours();
          let min = now.getMinutes();
          let perios = "AM";
  
          if (time > 11) {
            perios = "PM";
            if (time > 12) time -= 12;
          }
          if (min < 10) {
            min = "0" + min;
          }
          return `${month} ${date} | ${time}:${min}${perios}`;
        }
  
        currDate.innerHTML = getCurrentDay() + " | " + getCurrentTime();
    </script>
    
  </body>
  
</html>
